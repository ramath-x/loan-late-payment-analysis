# การวิเคราะห์การชำระเงินล่าช้าของเงินกู้

## คำอธิบายปัญหา

โปรเจกต์นี้ใช้ SQL เพื่อวิเคราะห์ข้อมูลการชำระเงินล่าช้าในระบบจัดการเงินกู้ โดยมีวัตถุประสงค์หลัก ดังนี้:

1. นับจำนวนครั้งที่แต่ละเงินกู้มีการชำระเงินล่าช้า
2. คำนวณจำนวนวันทั้งหมดที่แต่ละเงินกู้มีการชำระล่าช้า
3. หาจำนวนวันสูงสุดที่แต่ละเงินกู้เคยชำระล่าช้า

## วิธีการแก้ปัญหา

เราใช้ Common Table Expressions (CTEs) เพื่อประมวลผลข้อมูลเป็นขั้นตอน:

1. `late_payments`: ระบุการชำระเงินล่าช้าโดยเปรียบเทียบยอดค้างชำระปัจจุบันกับก่อนหน้า
2. `delinquency_periods`: กรองช่วงเวลาที่มีการชำระล่าช้าต่อเนื่องออก
3. `arrears_history`: คำนวณวันเริ่มต้นและสิ้นสุดของแต่ละช่วงการชำระล่าช้า

คำสั่ง SQL สุดท้ายจะรวมข้อมูลเหล่านี้เพื่อสร้างสถิติที่ต้องการ

## การตั้งค่าฐานข้อมูล

1. สร้างตาราง `transaction` ด้วยโครงสร้างดังนี้:

```sql
CREATE TABLE "transaction" (
  id SERIAL PRIMARY KEY,
  loan_id varchar,
  effective_date timestamptz,
  arrears_amount numeric
);
```
